# Scroll Restoration

/ Scroll Restoration используется для управления положением прокрутки при навигации между маршрутами. Он позволяет сохранять и восстанавливать положение прокрутки страницы. */ 

Этот компонент имитирует восстановление прокрутки в браузере при изменении местоположения после завершения загрузки, чтобы обеспечить восстановление прокрутки в нужном месте, даже на разных доменах.

Эта функция работает только при использовании маршрутизатора, см. «Выбор маршрутизатора»

Вам следует отображать только один из них, и рекомендуется отображать его в корневом маршруте вашего приложения:

```jsx
import { ScrollRestoration } from "react-router-dom";

function RootRouteComponent() {
  return (
    <div>
      {/* ... */}
      <ScrollRestoration />
    </div>
  );
}
```

getKey
Дополнительный реквизит, определяющий ключ, который React Router должен использовать для восстановления позиций прокрутки.

```jsx
<ScrollRestoration
  getKey={(location, matches) => {
    // default behavior
    return location.key;
  }}
/>
```

По умолчанию используется location.key для имитации поведения браузера по умолчанию без маршрутизации на стороне клиента. Пользователь может переходить по одному и тому же URL-адресу несколько раз в стеке, и каждая запись получает собственную позицию прокрутки для восстановления.

Некоторые приложения могут захотеть изменить это поведение и восстановить положение в соответствии с чем-то другим. Рассмотрим социальное приложение с четырьмя основными страницами:

"/главная страница"
"/сообщения"
"/уведомления"
"/поиск"
Если пользователь заходит на страницу «/home», прокручивает страницу немного вниз, нажимает «сообщения» в меню навигации, а затем нажимает «home» в меню навигации (а не кнопку «Назад!»), в стеке истории будет три записи:

1. /home
2. /messages
3. /home
По умолчанию в React Router (и в браузере) для 1 и 3 сохраняются две разные позиции прокрутки, даже если у них один и тот же URL. Это означает, что при переходе пользователя с 2 на 3 позиция прокрутки перемещается вверх, а не восстанавливается до того состояния, в котором она была в 1.

Разумное решение для продукта — сохранять позицию прокрутки пользователя в главной ленте, независимо от того, как он туда попал (нажатием кнопки «Назад» или переходом по новой ссылке). Для этого можно использовать location.pathname в качестве ключа.

```jsx
<ScrollRestoration
  getKey={(location, matches) => {
    return location.pathname;
  }}
/>
```

Или вы можете использовать имя пути только для некоторых путей, а для остальных использовать обычное поведение:

```jsx
<ScrollRestoration
  getKey={(location, matches) => {
    const paths = ["/home", "/notifications"];
    return paths.includes(location.pathname)
      ? // home and notifications restore by pathname
        location.pathname
      : // everything else by location like the browser
        location.key;
  }}
/>
```

Предотвращение сброса прокрутки
Когда при навигации создаются новые клавиши прокрутки, позиция прокрутки сбрасывается в начало страницы. Вы можете отключить функцию «прокрутка вверх» для своих ссылок и форм:

```jsx
<Link preventScrollReset={true} />
<Form preventScrollReset={true} />
```

Смотрите также: \<Link preventScrollReset>, \<Form preventScrollReset>

Мигание Прокрутки
Без фреймворка для рендеринга на стороне сервера, такого как Remix, при начальной загрузке страницы может наблюдаться мигание прокрутки. Это связано с тем, что React Router не может восстановить положение прокрутки до тех пор, пока не загрузятся ваши JS-связки, не загрузятся данные и не отобразится вся страница (если вы отображаете индикатор выполнения, размер области просмотра, скорее всего, не соответствует размеру, который был при сохранении положения прокрутки).

Фреймворки серверного рендеринга могут предотвратить мигание прокрутки, поскольку они могут отправлять полностью сформированный документ при первоначальной загрузке, чтобы прокрутка могла быть восстановлена при первой отрисовке страницы.


[Вернуться к содержанию](./index.md)